<link href="https://cdn.quilljs.com/1.3.6/quill.bubble.css" rel="stylesheet" />
<div 
  id="editor_quill_container"
  phx-update="ignore"
  class={"relative h-full"} 
  x-data="{
    open: false,
    close(focusAfter) {
      if (! this.open) return
      this.open = false
      focusAfter && focusAfter.focus()
    }
  }"
  x-on:keydown.escape.prevent.stop="close($refs.button)"
  >
  <div 
    id="editor_quill"
    phx-hook="QuillEditor"
    data-insert_text={e(assigns, :smart_input_text, "")}
    class={
      "h-full",
      "!h-full": e(assigns, :showing_within, nil) == :page,
      "h-auto rounded-[24px] border border-base-content/30": e(assigns, :thread_mode, nil) == :flat
      }
    >
    <div 
      id="editor"
      class={
        "text-base-content pr-[30px]",
        "min-h-[30px]": e(assigns, :thread_mode, nil) == :flat
        }
      data-placeholder={@smart_input_prompt}
      >{@content}
    </div>
    <input 
      id="quill_content"
      name={@field_name} 
      type="hidden"
      class="editor_hidden_input"
    />
  </div>
  <div 
    @click="open = ! open" 
    class={
      "absolute z-30 top-1 right-1 btn btn-ghost btn-sm text-[16px] btn-circle",
      "top-3": e(assigns, :thread_mode, nil) == :flat
    }>
      ğŸ˜›
  </div>
  <div 
    x-ref="panel"
    x-show="open"
    x-transition.origin.top.left
    x-on:click.outside="close($refs.button)"
    x-show="open" 
    :class="{'!right-3' : distraction_free}"
    class={
      "absolute z-40",
      "bottom-0": e(assigns, :thread_mode, nil) == :flat,
      "top-10": e(assigns, :thread_mode, nil) != :flat,
      "!top-10 right-0 bottom-[auto]": e(assigns, :showing_within, nil) == :page
    } 
    role="tooltip">
      <div 
        id="picker"
        ></div>
  </div>
</div>
